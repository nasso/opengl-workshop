<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Your own shader program - OpenGL Workshop</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../custom.css">
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../setup.html"><strong aria-hidden="true">2.</strong> Setup</a></li><li class="chapter-item expanded "><a href="../hello-triangle/index.html"><strong aria-hidden="true">3.</strong> Hello, Triangle!</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../hello-triangle/clear.html"><strong aria-hidden="true">3.1.</strong> Clearing the screen</a></li><li class="chapter-item expanded "><a href="../hello-triangle/shaders.html" class="active"><strong aria-hidden="true">3.2.</strong> Your own shader program</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">OpenGL Workshop</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="your-own-shader-program"><a class="header" href="#your-own-shader-program">Your own shader program</a></h1>
<p>It's time! Time for what you ask? Well, time to write your very own pair of GLSL
shaders of course!</p>
<p>You might be wondering what I'm talking about, so let's reiterate, shall we?</p>
<h2 id="what-is-a-shader"><a class="header" href="#what-is-a-shader">What is a shader?</a></h2>
<p>Shaders are pieces of software that run on your GPU. They are used to perform
specialised calculations based on a set of inputs in parallel. They are written
in a language specific to the graphics API you're using. The <em>OpenGL Shading
Language</em>, abbreviated as <em>GLSL</em>, is the one we're going to use today. Examples
of other shading languages include <em>HLSL</em> (<em>High-Level Shading Language</em>),
mainly used by Microsoft's Direct3D APIs, <em>MSL</em> (<em>Metal Shading Language</em>) for
Metal, by Apple, and <em>SPIR-V</em>, a portable binary format popularised by Vulkan.</p>
<blockquote>
<p>Don't worry! GLSL is actually very close to C! It just comes with fancy
features that make it easier to write shaders: types such as <code>vec2</code>, <code>vec3</code>,
<code>vec4</code> to represent vectors and built-in mathematical functions like
<code>distance</code>, <code>normalize</code> and <code>cross</code>.</p>
</blockquote>
<p>Depending on their role in the graphics pipeline, shaders can take several
names:</p>
<h3 id="vertex-shaders"><a class="header" href="#vertex-shaders">Vertex shaders</a></h3>
<p>The first step when rendering anything, is to give a position to each vertex.
This is exactly what the <em>vertex shader</em> is for! It is executed once for each
vertex, to calculate its coordinates on screen. Typically, this is where you
would apply transformations and 3D projections.</p>
<pre><code class="language-glsl">#version 330 core

layout(location = 0) in vec2 a_Position;

void main() {
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
</code></pre>
<p>Here are a couple things to note about this example shader:</p>
<ul>
<li>It has a single input: <code>a_Position</code>, a 2D vector. The <code>layout(location = 0)</code>
part just means &quot;this is input #0&quot;.</li>
<li>It constructs a 4D vector from <code>a_Position</code> and stores it into <code>gl_Position</code>.
The <code>z</code> component is set to <code>0.0</code> and <code>w</code> (the fourth component) is set to
<code>1.0</code>.</li>
</ul>
<p>The main output of our vertex shader is the <code>gl_Position</code> variable, holding the
coordinates of a single point of the geometry we're drawing on screen!</p>
<blockquote>
<p>You might wonder why <code>gl_Position</code> is a <code>vec4</code> instead of a <code>vec2</code> or a
<code>vec3</code>. This has to do with something called <a href="https://en.wikipedia.org/wiki/Homogeneous_coordinates">homogeneous coordinates</a>. Don't
worry too much about it for now, just keep in mind that <code>w</code> should be set to
<code>1.0</code>!</p>
</blockquote>
<p>The inputs of a vertex shader can be anything you want! For example, you could
keep it simple and just feed it plain 2D coordinates like in the example above.
But you could also feed it 3D coordinates and matrices, and let it do the math
to figure out the final 2D position! Don't worry, your GPU <em>loves</em> doing math.</p>
<h4 id="exercise-compiling-a-vertex-shader"><a class="header" href="#exercise-compiling-a-vertex-shader">Exercise: compiling a vertex shader</a></h4>
<p>To create a shader, you can use <code>glCreateShader</code>. Once created, you can load the
GLSL source code with <code>glShaderSource</code> and compile it with <code>glCompileShader</code>. To
make it easier for you to write your shaders in separate files (typically <code>*.vs</code>
for vertex shaders and <code>*.fs</code> for fragment shaders), I've written a helper
function to read a file in a heap-allocated string:</p>
<pre><code class="language-c">char* source = read_file(&quot;./res/my_shader.vs&quot;);

GLuint shader = glCreateShader(GL_VERTEX_SHADER);
glShaderSource(shader, 1, &amp;source, NULL);
glCompileShader(shader);

// don't forget to free the shader source string!
free(source);
</code></pre>
<p>Just don't forget to <code>#include &quot;utils.h&quot;</code> at the top of your C source file.</p>
<p>Try creating and compiling a vertex shader (for instance, the above example)
using those functions.</p>
<blockquote>
<p>You can use <code>glGetShaderiv</code> and <code>glGetShaderInfoLog</code> to see if your shader
successfully compiled! Try inserting a syntax error and see if you can get a
meaningful error message from it.</p>
</blockquote>
<h3 id="fragment-or-pixel-shaders"><a class="header" href="#fragment-or-pixel-shaders">Fragment (or pixel) shaders</a></h3>
<p>After the vertex shader computed the positions of each triangle (GPUs can only
draw triangles), the next step is to actually fill them with colourful pixels!
Now, to decide what colour each pixel takes, another kind of shader is executed:
the <em>fragment shader</em> (also known as <em>pixel shader</em>).</p>
<blockquote>
<p>Yes, it is executed for each individual pixel on screen. That means cycles are
precious at this stage! Luckily, this is what modern GPUs are optimised for.</p>
</blockquote>
<p>Unlike the vertex shader, you cannot <em>directly</em> feed per-pixel input to your
fragment shader. However, you can pass variables from your vertex shader to your
fragment shader! Different values between two vertices will be linearly
interpolated.</p>
<pre><code class="language-glsl">#version 330 core

// coming from an output of the vertex shader!
in vec3 v_Color;

// the final colour of the pixel!
out vec4 o_Color;

void main() {
  o_Color = vec4(v_Color, 1.0);
}
</code></pre>
<h4 id="exercise-compiling-a-fragment-shader"><a class="header" href="#exercise-compiling-a-fragment-shader">Exercise: compiling a fragment shader</a></h4>
<p>Fragment shaders are compiled the exact same way as vertex shaders (don't forget
to specify <code>GL_FRAGMENT_SHADER</code> when creating it though).</p>
<blockquote>
<p>Because of how similar it is to compile vertex and fragment shaders, you could
maybe write a helper function to do it for you...</p>
</blockquote>
<h2 id="a-shader-program"><a class="header" href="#a-shader-program">A shader program</a></h2>
<p>You now have a vertex shader and a fragment shader compiled! It's now time to
link them together, just like you would link two object files together to get a
full program.</p>
<p>The function to do that is conveniently called <code>glLinkProgram</code>. Use it to link a
shader program for the two shaders you have compiled.</p>
<blockquote>
<p>Just like compilation, linkage can fail! You can use <code>glGetProgramiv</code> and
<code>glGetProgramInfoLog</code> to get information about any error that occurred when
linking your shaders.</p>
</blockquote>
<p>Did it successfully link? Make sure it does (you might have to modify your
shaders)!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../hello-triangle/clear.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../hello-triangle/clear.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
